# ものづくり_原稿整理ツール 国語


## フォルダ構成## フォルダ構成

```text
manuscript_review/
├── src/                    # ソースコードフォルダ
│   ├── review.py            # メインプログラム
│   └── doc_util.py          # Word関連のユーティリティ
│   └── llm_util.py          # LLM関連のユーティリティ
│   └── check.py　　　　　　　# checkの実装
├── test/                  # テストフォルダ
├── docs/                   # 原稿配置フォルダ
├── requirements.txt        # 必要なパッケージ一覧
└── README.md            # プロジェクト説明
```
# 機能

## フォントチェック機能
指定されたWordファイル内の段落から「問~」形式の文字列を検出し、そのフォントが **MSゴシック**であるかを確認します。

## 傍注部分と傍注の説明部分がマッチするかのチェックを追加
ファイル全体から、「一　現代文（評論）」のように大問の開始パターンを検知し、そこから、「問」までを抽出します。
抽出後のテキストから傍注リストを抜き出します。
また、抽出後のテキストには傍注の説明も混じっているため、さらに本文を抽出後、傍注がある段落ごと抜き出します。

傍注がある段落と傍注リストを突き合わせ、存在しているかどうかチェックします。

- 条件
  - 傍注リスト
    - 「（注）」から始まり、最後の傍注のフレーズまで、抜き出しそこから、数字で始まるワードから傍注単語を抜き出すします。


### 検知対象
以下の形式を検出します：
- 「問一」〜「問十」
- 「問十一」〜「問二十」
### 問の連番チェックの前提条件
- 一から九十九までの漢数字とする
- 漢数字の〇利用しないものとする"問三〇"とは記載されず、"問三十"と記載されるものとする

### 解説の記述設問時に開設のポイントが含まれているかチェックする機能
- 前提
  - 解説のDOCXファイルに「●前提条件」「解答・配点」の記載がある
- 動作
  - 「●前提条件」～「解答・配点」内の設問のテキストを抽出しチェックする

### 解説文中に「正答」が含まれているかチェックを追加
- 「●設問解説」～「解答・配点」までのテキストを抜き出し、その中から問から次の問までの文章をLLMに送信する。解説の説明で、正答という表現が使われていないパターンである「したがって、正解は３」のようなものがあればNGとなる。

### エラー条件
- 「問~」のフォントが MSゴシック ではない場合。
